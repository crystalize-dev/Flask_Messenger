<!DOCTYPE html>
<html lang="en">
<head>
	<title>Money Hunt</title>
	<meta charset="utf-8">
	
	<link rel="stylesheet" type="text/css" href="../static/css/reset.css">
	<link rel="stylesheet" type="text/css" href="../static/css/responsive.css">
	<link rel="stylesheet" type="text/css" href="../static/css/games.css">
	
	<SCRIPT LANGUAGE="JavaScript">
    var gameOver;
    var cardCount;

    function Shuffle(max) {
      var num = Math.random() * max;
      return Math.round(num) + 1;
    }

    function getSuit() {
      suit = Shuffle(4);
      if (suit == 1) return "Пики";
      if (suit == 2) return "Трефы";
      if (suit == 3) return "Бубны";
      else return "Червы";
    }

    function cardName(card) {
      if (card == 1) return "Туз";
      if (card == 11) return "Валет";
      if (card == 12) return "Королева";
      if (card == 13) return "Король";
      return "" + card;
    }

    function cardValue(card, strWho) {
      if (card == 1) {
        if (strWho == "You" && document.display.you.value > 10) {
          document.display.say2.value = document.display.say2.value + " Low";
          return 1;
        } else return 11;
      }
      if (card > 10) return 10;
      return card;
    }

    function PickACard(strWho) {
      card = Shuffle(12);
      suit = getSuit();
      if (strWho == "You")
        document.display.say2.value = (cardName(card) + " " + suit);
      else
        document.display.say1.value = (cardName(card) + " " + suit);
      return cardValue(card, strWho);
    }

    function NewHand(form) {
      if (gameOver != 0) {
        form.say1.value = ("Рука в игре!");
        form.say2.value = ("");
        return;
      } else {
        form.dealer.value = 0;
        form.you.value = 0;
        cardCount = 0;
        form.dealer.value = eval(form.dealer.value) + PickACard("Dealer");
        form.you.value = eval(form.you.value) + PickACard("You");
        gameOver = -1;
        cardCount += 1;
      }
    }

    function Dealer(form) {
      if (gameOver == 0) {
        form.say1.value = ("Возьмите карту!");
        form.say2.value = ("");
        return;
      } else
      if (form.you.value < 10) {
        form.say1.value = ("Меньше 10!");
        form.say2.value = ("Возьмите карту!");
        return;
      } else
      if (cardCount < 2) {
        form.say1.value = ("Минимум 2 карты!");
        form.say2.value = ("Возьмите ещё!");
        return;
      } else
        while (form.dealer.value < 17) {
          form.dealer.value = eval(form.dealer.value) + PickACard("Dealer");
        }
    }

    function User(form) {
      if (gameOver == 0) {
        form.say1.value = ("Возьмите карту!");
        form.say2.value = ("");
        return;
      } else {
        cardCount += 1;
        form.say1.value = ("Вы получаете...");
        form.you.value = eval(form.you.value) + PickACard("You");
      }
      if (form.you.value > 21) {
        form.say1.value = ("Вы проиграли!");
        gameOver = 0;
        form.numgames.value = eval(form.numgames.value) - 1;
      }
    }

    function LookAtHands(form) {
      if (gameOver == 0 || form.you.value < 10 || cardCount < 2) {
        return;
      } else
      if (form.dealer.value > 21) {
        form.say1.value = ("Диллер проиграл!");
        form.say2.value = ("Вы выйграли!");
        gameOver = 0;
        form.numgames.value = eval(form.numgames.value) + 1;
      } else
      if (form.you.value > form.dealer.value) {
        form.say1.value = ("Вы выйграли!");
        form.say2.value = ("$");
        gameOver = 0;
        form.numgames.value = eval(form.numgames.value) + 1;
      } else
      if (form.dealer.value == form.you.value) {
        form.say1.value = ("Ничья!");
        form.say2.value = ("Попробуйте снова");
        gameOver = 0;
        form.numgames.value = eval(form.numgames.value) - 1;
      } else {
        form.say1.value = ("Диллер выйграл");
        form.say2.value = ("Вот незадача!");
        gameOver = 0;
        form.numgames.value = eval(form.numgames.value) - 1;
      }
    }

    function setBj() {
      gameOver = 0;
      cardCount = 0;
      document.display.dealer.value = "";
      document.display.you.value = "";
      document.display.numgames.value = "0";
      document.display.say1.value = " Возьмите карту";
      document.display.say2.value = " ";
    }
  </script>
</head>
<body OnLoad="setBj()">
	<section class="hero">
		<header>
			<div class="wrapper">
				<a><img src="../static/img/logo.png" class="logo"/></a>
				<nav>
					<a href="{{ url_for('main_page') }}" class="login_btn">На главную</a>
				</nav>
			</div>
		</header>
	<div class="game1">
	<center>
		  <form name="display" class="display">
			<table bgcolor="#c0c0c0" border="1" cellspacing="0" cellpadding="3">
			  <tr>
				<td>
				  <center>Очки:</center>
				</td>
				<td>
				  <center>Дилер</center>
				</td>
				<td>
				  <center>
					<input type=text name="dealer" size="2" readonly>
				  </center>
				</td>
				<td>
				  <center>Карты:
					<input type=text name="say1" size="18" value="" readonly>
				  </center>
				</td>
			  </tr>
			  <tr>
				<td>
				  <center>
					<input type=text name="numgames" size="3" value="0" readonly>
				  </center>
				</td>
				<td>
				  <center>Игрок</center>
				</td>
				<td>
				  <center>
					<input type=text name="you" size="2" readonly>
				  </center>
				</td>
				<td>
				  <center>Карты:
					<input type=text name="say2" size="18" value="" readonly>
				  </center>
				</td>
			  </tr>
			  <tr>
				<td>
				  <center>
					<input type=button value="Взять карту" onClick="NewHand(this.form)">
				  </center>
				</td>
				<td colspan=3>
				  <center>
					<input type=button value=" Стоп " onClick="Dealer(this.form);LookAtHands(this.form);">
					<input type=button value=" Ещё " onClick="User(this.form)">
				  </center>
				</td>
			  </tr>
			</table>
		  </form>
    </center>
    </div>
	</section>
	<footer>
		<div class="copyrights wrapper">
			Copyright © 2021 All Rights Reserved.
		</div>
	</footer>
</body>
</html>